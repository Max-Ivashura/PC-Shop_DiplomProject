{% extends 'base.html' %}
{% load static %}
{% block title %}Корзина{% endblock %}
{% block css %}
    <link rel="stylesheet" href="{% static 'cart/css/detail.css' %}">
{% endblock %}
{% block content %}
    <!-- Уникальный контейнер для изоляции стилей -->
    <div class="cart-container">
        <div class="container my-5">
            <h1 class="mb-4">Корзина</h1>
            {% if cart.get_cart_items %}
                <!-- Таблица товаров -->
                <div class="table-responsive cart-table">
                    <table class="table table-bordered">
                        <thead>
                        <tr>
                            <th>Товар</th>
                            <th>Количество</th>
                            <th>Цена за единицу</th>
                            <th>Общая стоимость</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody id="cart-items">
                        {% include 'includes/cart_items.html' %}
                        </tbody>
                    </table>
                </div>
                <!-- Общая стоимость -->
                <div class="d-flex justify-content-between align-items-center mt-4">
                    <p class="lead mb-0">Общая стоимость: <strong id="total-price">{{ cart.get_total_price }}
                        руб.</strong></p>
                    <a href="{% url 'checkout' %}" class="btn btn-primary checkout-btn">
                        <i class="fas fa-shopping-bag me-2"></i>Оформить заказ
                    </a>
                </div>
            {% else %}
                <!-- Пустая корзина -->
                <div class="empty-cart text-center py-5">
                    <p class="lead">Ваша корзина пуста.</p>
                    <a href="{% url 'product_list' %}" class="btn btn-outline-primary">
                        <i class="fas fa-store me-2"></i>Перейти в каталог
                    </a>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Модальное окно для подтверждения удаления -->
    <div class="modal fade" id="confirmRemoveModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Подтвердите удаление</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Вы уверены, что хотите удалить этот товар из корзины?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                    <button type="button" class="btn btn-danger" id="confirm-remove">Удалить</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
<!-- JavaScript для обновления корзины -->
{% block scripts %}
    <script src="{% static 'cart/js/cart.js' %}"></script>
{% endblock %}
