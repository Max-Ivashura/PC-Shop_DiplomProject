{% extends 'base.html' %}
{% load static %}

{% block title %}Конфигуратор ПК | PC Shop{% endblock %}
{% block css %} <link rel="stylesheet" href="{% static 'configurator/css/configurator.css' %}"> {% endblock %}

{% block content %}
<!-- Основной контейнер конфигуратора -->
<div class="configurator-wrapper">
    <div class="row g-4">
        <!-- Визуальный блок сборки -->
        <div class="col-12 col-lg-6">
            <div class="build-visual p-4 rounded-3 shadow-sm">
                <h5 class="mb-4 text-center">Ваша сборка</h5>

                <!-- Слоты компонентов -->
                <div class="component-slots">
                    <!-- Процессор -->
                    <div class="slot cpu-slot mb-3" data-component="cpu">
                        <div class="slot-header bg-light rounded-top">
                            <i class="fas fa-microchip me-2"></i> Процессор
                        </div>
                        <div class="slot-body p-3 border rounded-bottom">
                            <div class="component-preview d-flex align-items-center">
                                <img src="{% static 'images/components/cpu-placeholder.png' %}"
                                     class="component-icon me-3"
                                     data-bs-toggle="tooltip"
                                     title="Выберите процессор">
                                <span class="component-name">Не выбран</span>
                            </div>
                        </div>
                    </div>

                    <!-- Материнская плата -->
                    <div class="slot motherboard-slot mb-3" data-component="motherboard">
                        <div class="slot-header bg-light rounded-top">
                            <i class="fas fa-motherboard me-2"></i> Материнская плата
                        </div>
                        <div class="slot-body p-3 border rounded-bottom">
                            <div class="component-preview d-flex align-items-center">
                                <img src="{% static 'images/components/motherboard-placeholder.png' %}"
                                     class="component-icon me-3"
                                     data-bs-toggle="tooltip"
                                     title="Выберите материнскую плату">
                                <span class="component-name">Не выбрана</span>
                            </div>
                        </div>
                    </div>

                    <!-- Оперативная память -->
                    <div class="slot ram-slot mb-3" data-component="ram">
                        <div class="slot-header bg-light rounded-top">
                            <i class="fas fa-memory me-2"></i> Оперативная память
                        </div>
                        <div class="slot-body p-3 border rounded-bottom">
                            <div class="component-preview d-flex align-items-center">
                                <img src="{% static 'images/components/ram-placeholder.png' %}"
                                     class="component-icon me-3"
                                     data-bs-toggle="tooltip"
                                     title="Выберите оперативную память">
                                <span class="component-name">Не выбрана</span>
                            </div>
                        </div>
                    </div>

                    <!-- Видеокарта -->
                    <div class="slot gpu-slot mb-3" data-component="gpu">
                        <div class="slot-header bg-light rounded-top">
                            <i class="fas fa-video me-2"></i> Видеокарта
                        </div>
                        <div class="slot-body p-3 border rounded-bottom">
                            <div class="component-preview d-flex align-items-center">
                                <img src="{% static 'images/components/gpu-placeholder.png' %}"
                                     class="component-icon me-3"
                                     data-bs-toggle="tooltip"
                                     title="Выберите видеокарту">
                                <span class="component-name">Не выбрана</span>
                            </div>
                        </div>
                    </div>

                    <!-- Блок питания -->
                    <div class="slot psu-slot mb-3" data-component="psu">
                        <div class="slot-header bg-light rounded-top">
                            <i class="fas fa-battery-full me-2"></i> Блок питания
                        </div>
                        <div class="slot-body p-3 border rounded-bottom">
                            <div class="component-preview d-flex align-items-center">
                                <img src="{% static 'images/components/psu-placeholder.png' %}"
                                     class="component-icon me-3"
                                     data-bs-toggle="tooltip"
                                     title="Выберите блок питания">
                                <span class="component-name">Не выбран</span>
                            </div>
                        </div>
                    </div>

                    <!-- Накопитель -->
                    <div class="slot storage-slot mb-3" data-component="storage">
                        <div class="slot-header bg-light rounded-top">
                            <i class="fas fa-hdd me-2"></i> Накопитель
                        </div>
                        <div class="slot-body p-3 border rounded-bottom">
                            <div class="component-preview d-flex align-items-center">
                                <img src="{% static 'images/components/storage-placeholder.png' %}"
                                     class="component-icon me-3"
                                     data-bs-toggle="tooltip"
                                     title="Выберите накопитель">
                                <span class="component-name">Не выбран</span>
                            </div>
                        </div>
                    </div>

                    <!-- Система охлаждения -->
                    <div class="slot cooler-slot mb-3" data-component="cooler">
                        <div class="slot-header bg-light rounded-top">
                            <i class="fas fa-fan me-2"></i> Система охлаждения
                        </div>
                        <div class="slot-body p-3 border rounded-bottom">
                            <div class="component-preview d-flex align-items-center">
                                <img src="{% static 'images/components/cooler-placeholder.png' %}"
                                     class="component-icon me-3"
                                     data-bs-toggle="tooltip"
                                     title="Выберите систему охлаждения">
                                <span class="component-name">Не выбрана</span>
                            </div>
                        </div>
                    </div>

                    <!-- Корпус -->
                    <div class="slot case-slot mb-3" data-component="case">
                        <div class="slot-header bg-light rounded-top">
                            <i class="fas fa-box-open me-2"></i> Корпус
                        </div>
                        <div class="slot-body p-3 border rounded-bottom">
                            <div class="component-preview d-flex align-items-center">
                                <img src="{% static 'images/components/case-placeholder.png' %}"
                                     class="component-icon me-3"
                                     data-bs-toggle="tooltip"
                                     title="Выберите корпус">
                                <span class="component-name">Не выбран</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Блок выбора компонентов -->
        <div class="col-12 col-lg-6">
            <div class="component-selector rounded-3 shadow-sm">
                <div class="selector-header p-3 bg-light rounded-top">
                    <h5 class="mb-0">Выбор компонентов</h5>
                </div>
                <div class="selector-body p-3">
                    <!-- Выбор категории -->
                    <div class="mb-4">
                        <select class="form-select" id="componentCategory">
                            {% for category in categories %}
                                <option value="{{ category.slug }}">{{ category.name }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- Список компонентов -->
                    <div id="componentList" class="component-list mb-4" style="max-height: 600px; overflow-y: auto;">
                        <!-- Компоненты подгружаются через AJAX -->
                    </div>

                    <!-- Кнопки управления -->
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary" id="checkCompatibilityBtn">
                            <i class="fas fa-check-circle me-2"></i> Проверить совместимость
                        </button>
                        <button class="btn btn-success" id="saveBuildBtn">
                            <i class="fas fa-save me-2"></i> Сохранить сборку
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Блок уведомлений -->
    <div class="alert-container mt-4">
        <div id="compatibilityAlert" class="alert alert-warning d-none" role="alert">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <span id="compatibilityMessage"></span>
        </div>
    </div>

    <!-- Итоговая информация -->
    <div class="total-info mt-4 p-4 rounded-3 shadow-sm">
        <div class="d-flex justify-content-between">
            <h5>Общая стоимость:</h5>
            <h5 id="totalPrice">0 ₽</h5>
        </div>
        <div class="progress mt-3">
            <div id="compatibilityProgress" class="progress-bar" role="progressbar"
                 style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                Совместимость: 0%
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{% static 'js/configurator.js' %}"></script>
<script>
    // Инициализация тултипов
    document.addEventListener('DOMContentLoaded', function() {
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        })
    });
</script>
{% endblock %}